**용어 정리**

1. 인터넷
    1. 전 세계의 컴퓨터와 네트워크가 TCP/IP 프로토콜을 통해 연결되어 정보를 주고받을 수 있는 거대한 `네트워크`
2. 네트워크
    1. 여러 대의 컴퓨터나 장치들이 서로 데이터를 주고받을 수 있도록 연결된 `시스템`
3. 프로토콜
    1. 컴퓨터와 네트워크 장치들이 서로 통신할 때 따라야 하는 규칙과 약속

>💡네트워크가 연결되어 인터넷을 이루고, 네트워크를 이루는 각각의 장치들은 통신을 위해 프로토콜이라는 규약을 지켜야 한다.

---

# 1. 포로토콜 계층 구조(Protocol Layers)

**용어 정리**

1. 개체(Entity)
    1. 통신에 참여하는 `노드`

---

- 프로토콜이 왜 필요한가?
    
    두 개의 개체가 통신하고자 할 때, 프로토콜이 요구된다.
    

통신이 간단하지 않을 때, 통신의 복잡한 임무를 여러 개의 계층 구조로 분할할 수 있다.

이 경우, 각 계층 별로 하나씩 여러 개의 프로토콜이 필요해진다.

EX) A와 B가 통신해야 하고, A는 한국인 B는 미국인

1. A가 편지 작성
2. 비밀 코드로 변환
3. 우체국으로 전달
4. B 우체국 도착
5. 비밀 코드로 변환
6. B 편지 수령

이 경우,

편지를 비밀 코드로 변환하는 계층과, 우체국으로 전달하는 계층으로 분리할 수 있을 것이다. 

비밀 코드로 변환하는 과정에서의 규칙, 우체국으로 전달할 때의 규칙 같이 계층 별 프로토콜이 필요할 것임을 알 수 있다.

---

# 2. OSI 모델

![](https://velog.velcdn.com/images/alstjr971/post/2640d57c-089b-4676-aee1-026901b8e3b1/image.png)

OSI  모델은 Layer-to-Layer 통신만 수행한다.

- 왼쪽의 Session 계층은 오른쪽의 Session 계층과만 통신(이해) 가능하다.

![](https://velog.velcdn.com/images/alstjr971/post/6ac63f13-5400-448b-b68f-90a6b744462d/image.png)


🤔왼쪽의 Session 계층이 결국 데이터를 Transport 계층으로 전달하는 과정이 있는데, 그럼 아래 계층과도 통신하는거 아닌가요❓

라고 교수님께 질문했었다.

답변 : 왼쪽, 오른쪽에서 일어나는 일련의 과정들은 내부적으로 일어나는 함수적 `호출`이지, 통신이 아니다.

클라이언트가 서버에 T라는 작업을 요청했을 때 서버 내부에서는 여러 개의 로직을 호출해 해당 요청에 대한 응답을 처리한다.

이때 서버의 a 메서드가 b 메서드를 호출하는 것을 ‘통신’한다고 표현하지 않는 것과 같다.

**OSI 모델을 이용한 교환**


![](https://velog.velcdn.com/images/alstjr971/post/05141b68-e323-4d39-a0d8-cfe78bd105dc/image.png)


애플리케이션에서 다른 애플리케이션과 통신할 때, 통신하고자하는 데이터와 헤더를 전달한다. (애플리케이션 계층)

이를 전달 받은 아랫 계층(표현 계층)은 해당 데이터에 자신의 헤더를 추가해 캡슐화하여 다시 아래 계층으로 전달하고, 이 과정을 반복한다.

물리 계층을 통해 상대 데이터를 전달받은 애플리케이션의 물리 계층은 해당 데이터를 디캡슐화하여 위 계층으로 전달하는 과정을 반복한다.

- 2계층에만 특이하게 T라는 `트레일러`라는게 추가된다는 점만 알고있자.

### OSI 계층 요약

1. 물리 계층(Physical Layer)
    1. bit를 전자, 전기적 신호로 전달하는 역할
    2. 컴퓨터 공학보단, 전자/전기 공학에 가까우므로 깊게 알 필요는 없다.
2. 데이터 링크 계층(Data Link  Layer)
    1. bit을 모아 `frame`이라는 단위로 만들고, 이를 hop to hop 으로 전달하는 역할을 한다
    2. 같은 네트워크 내 통신을 책임진다
    3. 데이터 링크 계층이 사용하는 주소는 MAC 주소다
3. 네트워크 계층(Network Layer)
    1. 출발지에서 목적지까지 `패킷`을 전달
    2. 패킷을 최선을 다해 전달하지만, 무결성을 일체 검증하지 않는다.
4. 전송 계층(Transport Layer)
    1. 신뢰할 수 있는 전달을 보장한다.
5. 세션 계층(Session Layer)
    1. 영상 연결, 인터넷 연결, 트랜잭션 등을 묶은 Session 을 관리
6. 표현 계층(Presentation Layer)
    1. 암호화, 압축, 번역 등의 작업을 수행
7. 애플리케이션 계층(Application Layer)
    1. 네트워크 자원 요청
    2. 사용자와 직접적인 상호작용 담당

---

# 3. TCP/IP Protocol Suite(그룹)

**용어 정리**

1. 라우터
    1. 서로 다른 네트워크를 연결해주는 장치

TCP/IP 프로토콜 그룹은 OSI 모델보다 먼저 개발되었다.

그래서 TCP/IP 프로토콜에서의 Layer는 OSI 모델의 Layer 모델과 정확하게 일치하지 않는다.

원래의 TCP/IP 프로토콜 그룹은 4개의 소프트웨어 계층으로 규정되어 있었지만, 오늘날 TCP/IP는 OSI 모델에 있는 계층들과 비슷하게 지어진 이름을 3개의 계층 모델로 다뤄지고 있다.

![](https://velog.velcdn.com/images/alstjr971/post/ef75785b-422b-4c9b-b7cd-f21ac8078c4d/image.png)


- 옛날에는 하드웨어와 그를 제어하는 운영체제를 네트워크 인터페이스라는 하나의 묶음으로 보았다.

## OSI 7 모델과 TCP/IP 간 비교

![](https://velog.velcdn.com/images/alstjr971/post/a861bc7b-635c-41ea-b3a2-6e5cb7f478f6/image.png)


- TCP/IP 모델에서는 OSI의 5,6,7 계층을 하나로 묶어 Application 계층으로 표현한다.
- 그 아래 계층은 OSI 모델과 동일

1. Application Layer
    1. 서버 애플리케이션 프로토콜
    2. 네트워크 자원 요청
2. Transport Layer
    1. 전송 프로토콜
3. Network Layer
    1. 인터넷 프로토콜
4. Data Link, Physical Layer
    1. LAN, WAN 기술 기반

## TCP/IP 프로토콜 그룹(Suite)의 계층

![](https://velog.velcdn.com/images/alstjr971/post/f5fe3539-85ea-4b98-8ae6-3e67612f8821/image.png)


- 6개의 서로 다른 네트워크가 존재
- 6개의 네트워크를 연결하기 위한 4개의 라우터 존재
- 호스트는 2개
- 여기서 ‘개체’는 통신에 참여하는 노드를 의미하므로, 네트워크와 호스트 포함 8개로 볼 수 있다.

### 물리 계층 통신

![](https://velog.velcdn.com/images/alstjr971/post/f3f0edf7-8ac6-4f60-80c9-fb3be0bba954/image.png)


>💡물리 계층의 통신 단위는 `비트(bit)`다.

- A에서 B로 가기 위해 중간에 연결된 라우터로 비트를 보낸다.
- 라우터는 IN 으로 받고,  OUT으로 다른 라우터/개체에 이를 전달

### 데이터링크 계층 통신

![](https://velog.velcdn.com/images/alstjr971/post/58f883f8-f636-482e-b2e0-0e0046bb2a64/image.png)


>💡데이터 링크 계층의 통신 단위는 `프레임(frame)`이다.
- Data Link 계층에서 frame들이 비트로 쪼개져 물리 계층으로 전달되고, 이를 물리 계층 통신을 통해 다른 개체로 전달
- 이를 전달 받은 개체는 bit를 frame으로 묶어서 상위 계층으로 전달
    - 이때 개체는 당연히 물리 계층!
    - 물리 계층에서 데이터 링크 계층으로 전달하고, 이를 디캡슐화
- 논리적 흐름이 이렇다는 것이지, 실제로 1,2 계층은 목적지 이동을 위한 길, 경로를 모른다.
    - 경로와 목적지 설정은 3계층, 4계층에서 이뤄진다.

### 네트워크 계층 통신

![](https://velog.velcdn.com/images/alstjr971/post/56b87642-78ca-40b4-a9e4-a3784ab612b7/image.png)


>💡네트워크 계층의 통신 단위는 `데이터그램(datagram)`이다.

데이터 그램을 한국어로 번역하자면 `떠돌이` 정도로 볼 수 있다.


- 3계층에서 만들어진 데이터그램 안 헤더에는 출발지 주소와 목적지 주소가 적혀있을 것
- 네트워크 상 데이터그램(패킷) 경로는 다익스트라 알고리즘과 같은 최단 경로 탐색 알고리즘으로 매번 변경될 수 있음
    - 이게 인터넷 발달의 근원이 되었다.

### 전송 계층 통신

![](https://velog.velcdn.com/images/alstjr971/post/fbc1affd-90a4-4e34-972d-b7c554131ca4/image.png)


>💡전송 계층의 통신 단위는 특정 프로토콜에 따라(TCP, UDP) `세그먼트(Segment)`, `사용자 데이터그램(User Datagram)`, 패킷(Packet)이다.

- 세그먼트 : 조각 → 다시 합칠 것을 암시(신뢰성 제공)
- 사용자 데이터그램 : 떠돌이 → 신뢰성 보장 X
- 패킷 : 3,4 계층 통신 단위를 패킷으로 퉁칠 때 부름
</aside>

- 출발지 - 목적지가 있을 때 그 사이에 존재하는 라우터들이 전달하는 데이터는 3계층까지이고, 목적지에 가서야 비로소 4계층 데이터인 세그먼트를 볼 수 있다.

### 응용 계층 통신

![](https://velog.velcdn.com/images/alstjr971/post/8cee2089-a8d7-434f-8e63-34593b22069b/image.png)


>💡응용 계층의 통신 단위는 `메시지(Message)`다.
- 요청 메시지
- 응답 메시지

- 전송 계층과 마찬가지로 출발지 - 목적지 사이에 존재하는 라우터들이 확인하는 데이터는 3계층 데이터까지다.

---

# 4. 주소 지정

**CP/IP 프로토콜을 이용한 인터넷(internet)은 4개의 서로 다른 계층 주소가 사용된다.**

1. 물리 주소 - 데이터 링크 계층(MAC)
2. 논리 주소 - 네트워크 계층(IP)
3. 포트 주소 - 전송 계층(PORT)
4. 응용-특수 주소 - 애플리케이션 계층

![](https://velog.velcdn.com/images/alstjr971/post/9f0f9558-38ca-4426-81a6-8d016d149b0c/image.png)


- 물리 주소가 10인 노드가 물리 주소가 87인 노드에게 `프레임` 전송
- 두 노드는 링크로 연결되어 있다(LAN)
- 데이터 링크 계층에서, 프레임은 헤더 내에 물리 주소를 포함하고 있고, 여기서는 이 주소만 필요하다.

송신자의 데이터링크 계층은 상위 계층으로부터 데이터를 수신했을 것이고, 수신된 데이터는 프레임 안에 캡슐화 된다.

프레임은 LAN을 통해 전달되고, 물리 주소가 87이 아닌 다른 물리 주소를 갖는 컴퓨터(노드)들은 프레임 헤더에 포함된 목적지 주소가 본인이 아닌 경우 폐기한다.

>💡대부분의 로컬 네트워크는 16진법 숫자 12개로 구성된 6바이트 물리 주소를 사용한다.
- `07:01:4B:2C:1F:01`


![](https://velog.velcdn.com/images/alstjr971/post/e6ae10af-fe98-444e-8ec0-1701d1ce218b/image.png)


물리 주소는 홉 → 홉 으로 갈 때마다 변경되지만, 논리 주소는 동일하게 유지된다.

- A,P 는 논리 주소를 의미

그림은 세 개의 LAN을 연결하는 두 개의 라우터를 가진 인터넷(internet)의 한 부분이다.

각 장치는 물리적 연결에 대해 한 쌍의 주소(물리 주소 + 논리 주소)를 가진다.

이 경우, 각 컴퓨터는 단지 한 링크에만 연결되어 있어 한 쌍의 주소를 가진다.

그러나, 각 라우터는 세 개의 네트워크를 연결하고 있으므로, 각 연결 당 하나씩 세 개의 주소 쌍을 가진다.

(왜 3개인가? To another network 까지 포함하기 때문)

논리 주소가 A이고 물리 주소가 10인 컴퓨터가 → 논리 주소가 P이고 물리 주소가 95인 컴퓨터로 패킷을 전송하고자 하는 그림이다.

>💡물리 주소는 목적지 주소를 먼저 작성하고, 논리 주소는 출발지 주소를 먼저 작성한 이유는 무엇인가?


구현을 생각했을 때 물리 주소는 상대방이 받자마자 볼 수 있어야 하므로 먼저 작성하는 것이 별다른 인덱스 슬라이싱 과정 없이 번역할 수 있어 타당해 보인다.

논리 주소의 출발지 주소를 먼저 작성한 것은 라우터가 패킷을 다른 네트워크로 전달할 때 패킷이 처음 시작한 위치를 확인할 수 있게 하기 위함이다.
